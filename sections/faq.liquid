<!-- sections/faq-premium.liquid -->
<section class="faq-section" id="faq-{{ section.id }}" data-section-id="{{ section.id }}">
  <div class="faq-wrapper">
    
    <!-- Header mit Badge-Style -->
    <div class="faq-header">
      <h2 class="faq-title">
        <span class="title-text">{{ section.settings.title_text | default: 'Why choose' }}</span>
        <span class="title-badge">{{ section.settings.title_badge | default: 'Simbye eSIM' }}</span>
      </h2>
      {% if section.settings.subtitle %}
        <p class="faq-subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}
    </div>

    <!-- FAQ Accordion Full Width -->
    <div class="faq-accordion">
      {% for block in section.blocks %}
        {% if block.type == 'faq_item' %}
          <div class="faq-item" {{ block.shopify_attributes }}>
            
            <button class="faq-button" 
                    aria-expanded="false"
                    aria-controls="answer-{{ block.id }}">
              
              <span class="faq-question">{{ block.settings.question }}</span>
              
              <span class="faq-icon">
                <svg class="icon-plus" width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <svg class="icon-minus" width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </span>
            </button>
            
            <div class="faq-answer" id="answer-{{ block.id }}" aria-hidden="true">
              <div class="faq-answer-inner">
                <div class="answer-text">
                  {{ block.settings.answer }}
                </div>
                
                {% if block.settings.show_button and block.settings.button_text != blank %}
                  <a href="{{ block.settings.button_link | default: '#' }}" class="answer-button">
                    {{ block.settings.button_text }}
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                      <path d="M5 12h14m-7-7l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <!-- Optional Bottom CTA -->
    {% if section.settings.show_bottom_cta %}
      <div class="faq-bottom-cta">
        <h3>{{ section.settings.cta_title | default: 'Noch Fragen?' }}</h3>
        <p>{{ section.settings.cta_text | default: 'Unser Support-Team antwortet in unter 60 Sekunden' }}</p>
        <a href="{{ section.settings.cta_link | default: '/pages/support' }}" class="cta-button">
          {{ section.settings.cta_button_text | default: 'Zum Support' }}
        </a>
      </div>
    {% endif %}

  </div>
</section>

<style>
/* Base Variables */
.faq-section {
  --primary: #009a61;
  --primary-hover: #00824f;
  --accent: #00d97e;
  --text-primary: #1a1a1a;
  --text-secondary: #666;
  --bg-section: #ffffff;
  --bg-item: #ffffff;
  --border: rgba(0, 0, 0, 0.08);
  --shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  --radius: 12px;
}

/* Dark Mode */
[data-theme="dark"] .faq-section {
  --text-primary: #ffffff;
  --text-secondary: #b0b0b0;
  --bg-section: #040404;
  --bg-item: rgba(255, 255, 255, 0.02);
  --border: rgba(255, 255, 255, 0.08);
  --shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  --accent: #00d97e;
}

/* Section Container */
.faq-section {
  padding: 80px 0;
  background: var(--bg-section);
  width: 100%;
  position: relative;
}

[data-theme="dark"] .faq-section {
  background: linear-gradient(180deg, #040404 0%, #050505 50%, #040404 100%);
}

/* Wrapper - Full Width */
.faq-wrapper {
  width: 100%;
  max-width: none;
  padding: 0 40px;
}

/* Header */
.faq-header {
  text-align: center;
  margin-bottom: 60px;
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}

/* Title mit Badge Style */
.faq-title {
  font-size: clamp(36px, 5vw, 64px);
  font-weight: 700;
  margin: 0 0 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20px;
  line-height: 1.2;
}

.title-text {
  color: var(--text-primary);
}

.title-badge {
  display: inline-block;
  background: var(--accent);
  color: #040404;
  padding: 12px 32px;
  border-radius: 100px;
  font-weight: 700;
}

[data-theme="dark"] .title-badge {
  background: var(--accent);
  color: #040404;
}

.faq-subtitle {
  font-size: 18px;
  color: var(--text-secondary);
  margin: 0;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

/* Accordion Container - Full Width */
.faq-accordion {
  width: 100%;
  max-width: none;
}

/* FAQ Items */
.faq-item {
  background: var(--bg-item);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  margin-bottom: 12px;
  overflow: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.faq-item:hover {
  box-shadow: var(--shadow);
  transform: translateY(-1px);
}

.faq-item.active {
  border-color: var(--primary);
  background: var(--bg-item);
}

[data-theme="dark"] .faq-item.active {
  border-color: var(--accent);
  background: rgba(0, 217, 126, 0.02);
}

/* FAQ Button */
.faq-button {
  width: 100%;
  padding: 24px 32px;
  background: none;
  border: none;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
  font-family: inherit;
  text-align: left;
  transition: padding 0.3s ease;
}

.faq-button:hover {
  padding-left: 36px;
}

/* Question Text */
.faq-question {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  flex: 1;
  line-height: 1.5;
}

/* Icon */
.faq-icon {
  position: relative;
  width: 24px;
  height: 24px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.faq-icon svg {
  position: absolute;
  color: var(--primary);
  transition: all 0.3s ease;
}

[data-theme="dark"] .faq-icon svg {
  color: var(--accent);
}

.icon-minus {
  opacity: 0;
  transform: rotate(-90deg);
}

.faq-item.active .icon-plus {
  opacity: 0;
  transform: rotate(90deg);
}

.faq-item.active .icon-minus {
  opacity: 1;
  transform: rotate(0);
}

/* Answer */
.faq-answer {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease-out;
}

.faq-answer-inner {
  padding: 0 32px 24px 32px;
}

.answer-text {
  font-size: 16px;
  line-height: 1.7;
  color: var(--text-secondary);
}

.answer-text p {
  margin: 0 0 12px;
}

.answer-text p:last-of-type {
  margin-bottom: 16px;
}

.answer-text strong {
  color: var(--text-primary);
  font-weight: 600;
}

/* Answer Button */
.answer-button {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: var(--primary);
  color: white;
  font-size: 14px;
  font-weight: 600;
  text-decoration: none;
  border-radius: 100px;
  transition: all 0.3s ease;
  margin-top: 8px;
}

.answer-button:hover {
  background: var(--primary-hover);
  transform: translateX(4px);
}

[data-theme="dark"] .answer-button {
  background: var(--accent);
  color: #040404;
}

[data-theme="dark"] .answer-button:hover {
  background: var(--primary);
  color: white;
}

/* Bottom CTA */
.faq-bottom-cta {
  max-width: 800px;
  margin: 60px auto 0;
  padding: 40px;
  background: linear-gradient(135deg, var(--bg-item) 0%, rgba(0, 154, 97, 0.02) 100%);
  border: 2px solid var(--primary);
  border-radius: 20px;
  text-align: center;
}

[data-theme="dark"] .faq-bottom-cta {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.02) 0%, rgba(0, 217, 126, 0.02) 100%);
  border-color: var(--accent);
}

.faq-bottom-cta h3 {
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 12px;
}

.faq-bottom-cta p {
  font-size: 16px;
  color: var(--text-secondary);
  margin: 0 0 24px;
}

.cta-button {
  display: inline-block;
  padding: 14px 32px;
  background: var(--primary);
  color: white;
  font-size: 16px;
  font-weight: 600;
  text-decoration: none;
  border-radius: 100px;
  transition: all 0.3s ease;
}

.cta-button:hover {
  background: var(--primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 10px 30px rgba(0, 154, 97, 0.2);
}

[data-theme="dark"] .cta-button {
  background: var(--accent);
  color: #040404;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .faq-section {
    padding: 60px 0;
  }
  
  .faq-wrapper {
    padding: 0 20px;
  }
  
  .faq-header {
    margin-bottom: 40px;
  }
  
  .faq-title {
    font-size: 32px;
    flex-direction: column;
    gap: 16px;
  }
  
  .title-badge {
    padding: 10px 24px;
    font-size: inherit;
  }
  
  .faq-subtitle {
    font-size: 16px;
  }
  
  .faq-button {
    padding: 20px;
  }
  
  .faq-button:hover {
    padding-left: 20px;
  }
  
  .faq-question {
    font-size: 16px;
  }
  
  .faq-answer-inner {
    padding: 0 20px 20px 20px;
  }
  
  .answer-text {
    font-size: 14px;
  }
  
  .faq-bottom-cta {
    padding: 32px 24px;
  }
  
  .faq-bottom-cta h3 {
    font-size: 24px;
  }
}

/* Animations */
@media (prefers-reduced-motion: no-preference) {
  .faq-item {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.4s ease-out forwards;
  }
  
  .faq-item:nth-child(1) { animation-delay: 0.05s; }
  .faq-item:nth-child(2) { animation-delay: 0.1s; }
  .faq-item:nth-child(3) { animation-delay: 0.15s; }
  .faq-item:nth-child(4) { animation-delay: 0.2s; }
  .faq-item:nth-child(5) { animation-delay: 0.25s; }
  .faq-item:nth-child(6) { animation-delay: 0.3s; }
  .faq-item:nth-child(7) { animation-delay: 0.35s; }
  .faq-item:nth-child(8) { animation-delay: 0.4s; }
  .faq-item:nth-child(9) { animation-delay: 0.45s; }
  .faq-item:nth-child(n+10) { animation-delay: 0.5s; }
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>

<script>
(function() {
  'use strict';
  
  function initFAQ() {
    const section = document.querySelector('#faq-{{ section.id }}');
    if (!section) return;
    
    const items = section.querySelectorAll('.faq-item');
    const buttons = section.querySelectorAll('.faq-button');
    
    // Toggle FAQ items
    buttons.forEach(button => {
      button.addEventListener('click', function() {
        const item = this.closest('.faq-item');
        const answer = item.querySelector('.faq-answer');
        const answerInner = answer.querySelector('.faq-answer-inner');
        const isOpen = item.classList.contains('active');
        
        // Close all other items
        items.forEach(otherItem => {
          if (otherItem !== item && otherItem.classList.contains('active')) {
            otherItem.classList.remove('active');
            const otherButton = otherItem.querySelector('.faq-button');
            const otherAnswer = otherItem.querySelector('.faq-answer');
            otherButton.setAttribute('aria-expanded', 'false');
            otherAnswer.style.maxHeight = '0';
            otherAnswer.setAttribute('aria-hidden', 'true');
          }
        });
        
        // Toggle current item
        if (isOpen) {
          item.classList.remove('active');
          this.setAttribute('aria-expanded', 'false');
          answer.style.maxHeight = '0';
          answer.setAttribute('aria-hidden', 'true');
        } else {
          item.classList.add('active');
          this.setAttribute('aria-expanded', 'true');
          answer.style.maxHeight = answerInner.offsetHeight + 'px';
          answer.setAttribute('aria-hidden', 'false');
        }
      });
    });
    
    // Keyboard navigation
    section.addEventListener('keydown', function(e) {
      if (!e.target.classList.contains('faq-button')) return;
      
      const currentItem = e.target.closest('.faq-item');
      const allItems = Array.from(items);
      const currentIndex = allItems.indexOf(currentItem);
      let targetIndex = currentIndex;
      
      switch(e.key) {
        case 'ArrowDown':
          e.preventDefault();
          targetIndex = currentIndex < allItems.length - 1 ? currentIndex + 1 : 0;
          break;
        case 'ArrowUp':
          e.preventDefault();
          targetIndex = currentIndex > 0 ? currentIndex - 1 : allItems.length - 1;
          break;
        case 'Home':
          e.preventDefault();
          targetIndex = 0;
          break;
        case 'End':
          e.preventDefault();
          targetIndex = allItems.length - 1;
          break;
        default:
          return;
      }
      
      allItems[targetIndex].querySelector('.faq-button').focus();
    });
    
    // Recalculate heights on window resize
    let resizeTimer;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function() {
        items.forEach(item => {
          if (item.classList.contains('active')) {
            const answer = item.querySelector('.faq-answer');
            const answerInner = answer.querySelector('.faq-answer-inner');
            answer.style.maxHeight = answerInner.offsetHeight + 'px';
          }
        });
      }, 250);
    });
  }
  
  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFAQ);
  } else {
    initFAQ();
  }
})();
</script>

{% schema %}
{
  "name": "FAQ Section",
  "class": "section-faq",
  "settings": [
    {
      "type": "text",
      "id": "title_text",
      "label": "Title Text (White)",
      "default": "Why choose"
    },
    {
      "type": "text",
      "id": "title_badge",
      "label": "Title Badge (Green)",
      "default": "Simbye eSIM"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle (Optional)"
    },
    {
      "type": "header",
      "content": "Bottom CTA (Optional)"
    },
    {
      "type": "checkbox",
      "id": "show_bottom_cta",
      "label": "Show Bottom CTA",
      "default": false
    },
    {
      "type": "text",
      "id": "cta_title",
      "label": "CTA Title",
      "default": "Noch Fragen?"
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Text",
      "default": "Unser Support-Team antwortet in unter 60 Sekunden"
    },
    {
      "type": "text",
      "id": "cta_button_text",
      "label": "CTA Button Text",
      "default": "Zum Support"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "CTA Link"
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Kann mein Handy eSIM?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Die meisten modernen Smartphones ab 2018 unterstützen eSIM-Technologie. Dazu gehören iPhone XS und neuer, Samsung Galaxy S20 und neuer, Google Pixel 3 und neuer.</p>"
        },
        {
          "type": "checkbox",
          "id": "show_button",
          "label": "Show Button",
          "default": false
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Mehr erfahren"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "question": "Kann mein Handy eSIM?",
            "answer": "<p><strong>Die meisten modernen Smartphones ab 2018 unterstützen eSIM.</strong> Dazu gehören iPhone XS und neuer, Samsung Galaxy S20 und neuer, Google Pixel 3 und neuer, sowie viele weitere Modelle.</p>",
            "show_button": true,
            "button_text": "Kompatibilität prüfen",
            "button_link": "/pages/check-esim"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Wie schnell erhalte ich meine eSIM?",
            "answer": "<p><strong>Sofort nach der Zahlung!</strong> Der QR-Code wird dir innerhalb von 30 Sekunden per E-Mail zugeschickt. Die komplette Installation dauert weniger als 2 Minuten.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Kann ich die eSIM mehrmals verwenden und aufladen?",
            "answer": "<p><strong>Ja, absolut!</strong> Simbye eSIMs sind vollständig wiederaufladbar. Du kannst jederzeit Daten über dein Dashboard nachkaufen. Die eSIM bleibt aktiv solange du sie mindestens alle 180 Tage nutzt.</p>",
            "show_button": true,
            "button_text": "Jetzt aufladen",
            "button_link": "/account"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Was passiert wenn mein Datenvolumen aufgebraucht ist?",
            "answer": "<p><strong>Die eSIM stoppt einfach - keine versteckten Kosten!</strong> Du bekommst Benachrichtigungen bei 50%, 80% und 95% Verbrauch. Danach kannst du sofort über unsere App oder Website aufladen.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Funktioniert die eSIM auch für WhatsApp Anrufe?",
            "answer": "<p><strong>Natürlich!</strong> Unsere eSIMs bieten vollwertiges Internet - perfekt für WhatsApp, FaceTime, Skype, Zoom und alle anderen VoIP-Dienste.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Kann ich mehrere eSIMs gleichzeitig nutzen?",
            "answer": "<p><strong>Ja, die meisten eSIM-Handys unterstützen mehrere Profile.</strong> Du kannst 5-10 verschiedene eSIMs speichern und zwischen ihnen wechseln.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Gibt es eine Geschwindigkeitsdrosselung?",
            "answer": "<p><strong>Keine Drosselung - niemals!</strong> Du bekommst volle 4G/5G Geschwindigkeiten bis zu 1 Gbit/s. Unlimited Pläne haben keine Fair-Use-Policy.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Wie kann ich meinen Datenverbrauch prüfen?",
            "answer": "<p><strong>Verfolge deinen Verbrauch in Echtzeit über:</strong> Die Einstellungen deines Handys, unsere Simbye App, E-Mail Benachrichtigungen oder dein Account Dashboard.</p>",
            "show_button": true,
            "button_text": "Zum Dashboard",
            "button_link": "/account"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "In welchen Ländern funktioniert Simbye eSIM?",
            "answer": "<p><strong>In über 190 Ländern weltweit!</strong> Von Europa über Asien bis Amerika - wir haben dich überall abgedeckt. Check unsere komplette Länderliste für alle Details.</p>",
            "show_button": true,
            "button_text": "Alle Länder anzeigen",
            "button_link": "/collections/all"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "Behalte ich meine normale Nummer?",
            "answer": "<p><strong>Ja, deine Nummer bleibt aktiv!</strong> Die eSIM läuft parallel zu deiner normalen SIM-Karte. Du kannst weiter Anrufe und SMS empfangen während du mit der eSIM surfst.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}